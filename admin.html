<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ê–¥–º–∏–Ω–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {font-family: Arial,sans-serif;background:#f9fafb;margin:0;padding:0;}
    header {background:#0096c7;color:#fff;text-align:center;padding:1rem;font-size:1.4rem;}
    .container {max-width:900px;margin:auto;padding:1rem;}
    h2 {margin-top:1.5rem;color:#0096c7;}
    select,input,button {padding:0.5rem 0.8rem;border:1px solid #ccc;border-radius:6px;font-size:1rem;margin:0.2rem 0;}
    button {cursor:pointer;background:#0096c7;color:white;border:none;transition:0.2s;}
    button:hover {background:#0077a6;}
    table {width:100%;border-collapse:collapse;margin-top:1rem;background:white;box-shadow:0 2px 5px rgba(0,0,0,0.1);}
    th,td {padding:0.8rem;border:1px solid #ddd;text-align:left;}
    th {background:#f0faff;}
    .actions button {margin-right:0.3rem;}
    .form-inline {display:flex;flex-wrap:wrap;gap:0.5rem;margin-top:1rem;}
    .form-inline input {flex:1;}
  </style>
</head>
<body>
<header>–ê–¥–º–∏–Ω–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤ –∏ —Ä–µ–≥–∏–æ–Ω–æ–≤</header>
<div class="container">
  <h2>–†–µ–≥–∏–æ–Ω</h2>
  <div class="form-inline">
    <select id="region-select"></select>
    <button id="rename-region">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
    <button id="delete-region">–£–¥–∞–ª–∏—Ç—å</button>
  </div>
  <div class="form-inline">
    <input type="text" id="new-region" placeholder="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ä–µ–≥–∏–æ–Ω">
    <button id="add-region">–î–æ–±–∞–≤–∏—Ç—å</button>
  </div>

  <h2>–¢–∞—Ä–∏—Ñ—ã –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞</h2>
  <table id="tariff-table">
    <thead>
      <tr>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–°–∫–æ—Ä–æ—Å—Ç—å</th>
        <th>–¶–µ–Ω–∞ (‚ÇΩ/–º–µ—Å)</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>–î–æ–±–∞–≤–∏—Ç—å —Ç–∞—Ä–∏—Ñ</h2>
  <div class="form-inline">
    <input type="text" id="tariff-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞">
    <input type="text" id="tariff-speed" placeholder="–°–∫–æ—Ä–æ—Å—Ç—å">
    <input type="number" id="tariff-price" placeholder="–¶–µ–Ω–∞">
    <button id="add-tariff">–î–æ–±–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
  const defaultData = {
    "–ú–æ—Å–∫–≤–∞":[{name:"–ë–∏–∑–Ω–µ—Å-100",speed:"100 –ú–±–∏—Ç/—Å",price:1200}],
    "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å":[{name:"–ú–û-50",speed:"50 –ú–±–∏—Ç/—Å",price:900}],
    "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥":[{name:"–°–ü–ë-100",speed:"100 –ú–±–∏—Ç/—Å",price:1000}]
  };

  function loadData() { 
    let data = JSON.parse(localStorage.getItem("tariffs")); 
    if(!data){ 
        data = defaultData; 
        localStorage.setItem("tariffs", JSON.stringify(data));
    }
    return data;
  }

  function saveData(data) { localStorage.setItem("tariffs", JSON.stringify(data)); }

  const regionSelect = document.getElementById("region-select");
  const tableBody = document.querySelector("#tariff-table tbody");

  function renderRegions() {
    const data = loadData();
    regionSelect.innerHTML = "";
    for (let r in data) {
      const option = document.createElement("option");
      option.value = r; option.textContent = r;
      regionSelect.appendChild(option);
    }
  }

  function renderTariffs() {
    const data = loadData();
    const region = regionSelect.value;
    tableBody.innerHTML = "";
    if(!data[region]) data[region]=[];
    data[region].forEach((t,i)=>{
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${t.name}</td>
        <td>${t.speed}</td>
        <td>${t.price}</td>
        <td class="actions">
          <button onclick="editTariff(${i})">‚úèÔ∏è</button>
          <button onclick="deleteTariff(${i})">üóëÔ∏è</button>
        </td>`;
      tableBody.appendChild(row);
    });
  }

  function addRegion(name){
    const data = loadData();
    if(name && !data[name]){ data[name]=[]; saveData(data); renderRegions(); regionSelect.value=name; renderTariffs();}
    else alert("–†–µ–≥–∏–æ–Ω —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Å—Ç–æ–µ –∏–º—è");
  }

  function renameRegion(newName){
    const data = loadData();
    const oldName = regionSelect.value;
    if(!newName || data[newName]) { alert("–ò–º—è –ø—É—Å—Ç–æ–µ –∏–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"); return; }
    data[newName] = data[oldName]; delete data[oldName];
    saveData(data); renderRegions(); regionSelect.value=newName; renderTariffs();
  }

  function deleteRegion(){
    const data = loadData();
    const region = regionSelect.value;
    if(confirm(`–£–¥–∞–ª–∏—Ç—å —Ä–µ–≥–∏–æ–Ω "${region}" –∏ –≤—Å–µ –µ–≥–æ —Ç–∞—Ä–∏—Ñ—ã?`)){
      delete data[region];
      saveData(data); renderRegions(); renderTariffs();
    }
  }

  function addTariff(name,speed,price){
    const data = loadData();
    const region = regionSelect.value;
    if(!data[region]) data[region]=[];
    data[region].push({name,speed,price:parseInt(price)});
    saveData(data); renderTariffs();
  }

  function editTariff(index){
    const data = loadData();
    const region = regionSelect.value;
    const t = data[region][index];
    const name = prompt("–ù–∞–∑–≤–∞–Ω–∏–µ:",t.name); 
    const speed = prompt("–°–∫–æ—Ä–æ—Å—Ç—å:",t.speed); 
    const price = prompt("–¶–µ–Ω–∞:",t.price);
    if(name && speed && price){ t.name=name; t.speed=speed; t.price=parseInt(price); saveData(data); renderTariffs(); }
  }

  function deleteTariff(index){
    const data = loadData();
    const region = regionSelect.value;
    data[region].splice(index,1);
    saveData(data); renderTariffs();
  }

  // —Å–æ–±—ã—Ç–∏—è
  regionSelect.addEventListener("change", renderTariffs);
  document.getElementById("add-region").addEventListener("click", ()=>{
    const name = document.getElementById("new-region").value.trim();
    if(name) addRegion(name); 
    else alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ä–µ–≥–∏–æ–Ω–∞");
  });
  document.getElementById("rename-region").addEventListener("click", ()=>{
    const newName = prompt("–ù–æ–≤–æ–µ –∏–º—è —Ä–µ–≥–∏–æ–Ω–∞:");
    if(newName) renameRegion(newName);
  });
  document.getElementById("delete-region").addEventListener("click", deleteRegion);
  document.getElementById("add-tariff").addEventListener("click", ()=>{
    const name=document.getElementById("tariff-name").value.trim();
    const speed=document.getElementById("tariff-speed").value.trim();
    const price=document.getElementById("tariff-price").value.trim();
    if(name && speed && price) { 
      addTariff(name,speed,price); 
      document.getElementById("tariff-name").value=""; 
      document.getElementById("tariff-speed").value=""; 
      document.getElementById("tariff-price").value=""; 
    } else alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ç–∞—Ä–∏—Ñ–∞");
  });

  // init
  renderRegions();
  renderTariffs();
</script>
</body>
</html>
